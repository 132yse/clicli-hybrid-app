<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <style>
        /*[v-cloak] {
            display: none;
        }*/

        html,
        body {
            background-color: #fff;
            padding: 0;
            margin: 0;
        }

        .content-container{
            margin-top: 56.25vw;
            padding: 10px 2vw;
            background-color: #FEFEFE;
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: wrap;
        }

        .video-item{
            width: 44vw;
            height: 80px;
            background-color: #009688;
            margin: 10px 2vw;
            border-radius: 5px;
            box-shadow: 0px 0px 8px #999;
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: wrap;
        }

        .video-item .avatar{
            height: 60px;
            width: 60px;
            padding: 10px;
            border-radius: 50%;
        }
        .video-item .intro{
            width: auto;
            display: inline;
        }
        .intro .oid{
            width: 100%;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }
        .intro .title{
            width: 100%;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

    </style>
</head>

<body>

    <div id="app" v-cloak>

        <div class="content-container">

                <div class="video-item">
                    <img src="http://q1.qlogo.cn/g?b=qq&nk=741755613&s=5" alt="" class="avatar">
                    <div class="intro">
                        <p class="oid">第1话555</p>
                        <p class="title">猪头帝来袭45646456</p>
                    </div>
                </div>

                <div class="video-item">
                    <img src="http://q1.qlogo.cn/g?b=qq&nk=741755613&s=5" alt="" class="avatar">
                    <div class="intro">
                        <p class="oid">第1话</p>
                        <p class="title">猪头帝来袭</p>
                    </div>
                </div>
                <div class="video-item">
                    <img src="http://q1.qlogo.cn/g?b=qq&nk=741755613&s=5" alt="" class="avatar">
                    <div class="intro">
                        <p class="oid">第1话</p>
                        <p class="title">猪头帝来袭</p>
                    </div>
                </div>

        </div>

    </div>

    <script src="../../script/api.js"></script>
    <script src="../../script/vue.min.js"></script>
    <script src="../../script/axios.min.js"></script>
    <script src="../../script/hyperdown.js"></script>
    <script type="text/javascript">
        apiready = () => {

            let pid = api.pageParam.pid
            let title = api.pageParam.title

            let _isFullScreen = false

            let videoPlayer = api.require('videoPlayer');
            videoPlayer.openPlay({
                rect: {
                    x: 0,
                    y: 0,
                    w: api.winWidth,
                    h: 9 / 16 * api.winWidth
                },
                texts: {
                    head: {
                        title
                    }
                },
                styles: {
                    head: {
                        bg: 'rgba(0.5,0.5,0.5,0.7)',
                        height: 44,
                        y: 20,
                        titleSize: 20,
                        titleColor: '#fff',
                        backSize: 22,
                        backImg: 'fs://image/back.png',
                        customButtons: [],
                    },
                    foot: {
                        bg: 'rgba(0,0,0,0)',
                        height: 44,
                        playSize: 22,
                        playImg: 'fs://img/paly.png',
                        pauseImg: 'fs://img/pause.png',
                        timeSize: 14,
                        timeColor: '#fff',
                        sliderImg: 'fs://img/slder.png',
                        progressColor: '#696969',
                        progressSelected: '#1296db',
                        rotationSize: 22,
                        verticalImg: 'widget://image/fullscreen.png',
                        horizontalImg: 'widget://image/fullscreen.png',
                    }
                },
                path: 'https://dl104.yunpan.360.cn/intf.php?method=Download.downloadFile&qid=1324323432&fname=%2F%E8%BF%9E%E8%BD%BD%E7%95%AA%2F2018%E7%A7%8B%E5%AD%A3%2F%E5%88%80%E5%89%91%E7%A5%9E%E5%9F%9F3%2F16.mp4&fhash=fb02c98b83cb1d4e627a1d1881c28a1981e879ec&dt=104_104.cb3cc40c91cb8f55bb6e5b9702b75ce8&v=1.0.1&rtick=15486897928689&open_app_id=0&host=dl104.yunpan.360.cn&devtype=ecs_web&sign=0b927c67004ddb0c1d92ebd033cc8fdf&&token=2177665571.8.469189c8.1324323432.15247416692400137.1548604862',
                coverImg: 'widget://image/coverImg.png',
                autoPlay: false,
                fixed: true
            }, function(ret, err) {

                // console.log(JSON.stringify(ret));

                if (ret.eventType === 'back') {
                    if (ret.value === false) {
                        api.closeWin();
                    }
                }
            });

            // videoPlayer.setPath({
            //     path: 'http://7o50kb.com2.z0.glb.qiniucdn.com/c1.1.mp4',
            //     coverImg: '',
            //     bg: '#fff',
            //     title: ''
            // });
            videoPlayer.close()

            api.addEventListener({
                name: 'keyback'
            }, function(ret, err) {
                //判断当前是否处于全屏播放
                videoPlayer.isFullscreen(function(ret) {
                    if (ret.isFullscreen === false) {
                        api.closeWin()
                    } else {
                        videoPlayer.onBack()
                    }
                })
            });

            const app = new Vue({
                el: '#app',
                data: {
                    postIntro: [],
                    postContent: '',
                    videosList: [],
                    postCount: {},
                    commentsList: []
                },
                mounted() {

                },
                methods: {
                    getPostIntro(){
                        axios({
                            method: 'get',
                            url: 'https://api.clicli.top/post/' + pid
                        }).then(response => {
                            if(response.data.code === 201){
                                this.postIntro = response.data.result
                                let parser = new HyperDown
                                let html = parser.makeHtml(response.data.result.content)
                                this.postContent = html
                            }
                        })
                    },
                    getVideosList(){
                        axios({
                            method: 'get',
                            url: 'https://api.clicli.top/videos?pid=' + pid + '&page=1&pageSize=100'
                        }).then(response => {
                            if(response.data.code === 201){
                                this.videosList = response.data.videos
                            }
                        })
                    },
                    getPostCount(){
                        axios({
                            method: 'get',
                            url: 'https://api.clicli.top/count/' + pid
                        }).then(response => {
                            if(response.data.code === 201){
                                this.postCount = response.data.count
                            }
                        })
                    },
                    getCommentsList(){
                        axios({
                            method: 'get',
                            url: 'https://api.clicli.top/comments?pid=' + pid + '&page=1&pageSize=100'
                        }).then(response => {
                            if(response.data.code === 201){
                                this.commentsList = response.data.comments
                            }
                        })
                    }
                }
            })

        }
    </script>
</body>

</html>
